using Microsoft.AspNetCore.Mvc;
using System.Threading.Tasks;

[ApiController]
[Route("api/[controller]")]
public class VulnerabilityController : ControllerBase
{
    private readonly ZapScannerService _zapService;

    public VulnerabilityController(ZapScannerService zapService)
    {
        _zapService = zapService;
    }

    [HttpGet("scan")]
    public async Task<IActionResult> GetZapAlerts()
    {
        var alerts = await _zapService.GetAlertsAsync();
        return Ok(alerts);
    }
}